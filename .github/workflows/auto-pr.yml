name: Auto PR Agent

permissions:
  contents: write
  pull-requests: write
  issues: write

on:
  workflow_dispatch: {}
  issues:
    types: [opened, edited, labeled]

jobs:
  open-pr:
    if: contains(github.event.issue.labels.*.name, 'build')
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          persist-credentials: true

      - name: Generate PR from issue (stub)
        run: |
          echo "Creating a PR from issue #${{ github.event.issue.number }}"
          echo "This is a placeholder step â€” replace with your generator when ready." > CHANGELOG_AUTOPR.txt

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v6
        with:
          commit-message: "feat: auto PR from issue #${{ github.event.issue.number }}"
          branch: auto/issue-${{ github.event.issue.number }}
          title: "Auto PR: ${{ github.event.issue.title }}"
          body: |
            Auto-generated from issue #${{ github.event.issue.number }}.
          labels: |
            build
          add-paths: |
            CHANGELOG_AUTOPR.txt
